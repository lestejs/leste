var leste=(()=>{var y=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var S=(s,t)=>{for(var e in t)y(s,e,{get:t[e],enumerable:!0})},q=(s,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of H(t))!C.call(s,o)&&o!==e&&y(s,o,{get:()=>t[o],enumerable:!(n=T(t,o))||n.enumerable});return s};var A=s=>q(y({},"__esModule",{value:!0}),s);var B={};S(B,{mount:()=>v});function j(s,t){let e=new WeakMap;function n(c){return{set(r,p,a,m){let f=[...c,p],O=f.join("_");return t.beforeSet&&(a=t.beforeSet(r,f,a,O)||a),a&&typeof a=="object"&&(a=i(a,f)),r[p]=a,t.set&&t.set(r,f,a,O),!0},get(r,p){return t.get&&t.get(r,[...c,p]),r[p]},deleteProperty(r,p){if(Reflect.has(r,p)){o(r,p);let a=Reflect.deleteProperty(r,p);return a&&t.deleteProperty&&t.deleteProperty(r,[...c,p]),a}return!1},getPrototypeOf(r){return{target:r,instance:"Proxy"}}}}function o(c,r){e.has(c[r])&&(c[r]=e.get(c[r]),e.delete(c[r]));for(let p of Object.keys(c[r]))c[r][p]!=null&&typeof c[r][p]=="object"&&o(c[r],p)}function i(c,r){for(let a of Object.keys(c))c[a]&&typeof c[a]=="object"&&(c[a]=i(c[a],[...r,a]));let p=new Proxy(c,n(r));return e.set(p,c),p}return i(s,[])}var b=null;function M(s,t){return clearTimeout(b),new Promise(e=>{b=setTimeout(()=>{s&&s(),clearTimeout(b),e()},t||0)})}function h(s){return!s||s instanceof HTMLCollection||s instanceof NodeList||s instanceof Element?s:JSON.parse(JSON.stringify(s))}var N=["Error props type","Node with ingrate must bu empty"];function P(){for(let[s,t]of Object.entries(this.node.classes)){let e=()=>{t()?this.nodeElement.classList.add(s):this.nodeElement.classList.remove(s)};this.refs.length=0,e(),this.nodeElement.reactive(this.refs,"classes",e)}}function _(s,t=300){let e;return(...n)=>{e||s.apply(this,n),clearTimeout(e),e=setTimeout(()=>{e=null},t)}}function J(s,t){typeof t=="function"&&(this.nodeElement[s]=e=>this.node[s].bind(this.context)(e,_))}function R(s,t){if(typeof t=="function"){let e=()=>{let n=t.bind(this.context)();typeof n=="object"?Object.assign(this.nodeElement[s],n):this.nodeElement[s]=n};this.refs.length=0,e(),this.nodeElement.reactive(this.refs,s,e)}else this.nodeElement[s]=t}function $(s,t){s in this.nodeElement&&(s.substr(0,2)==="on"?this.listeners(s,t):this.general(s,t))}var k={native:$,listeners:J,general:R};function g(s){let t=new this.Component(s||this.node.component,this.context,this.keyNode,this.nodeElement,this.common),e={},n=s?.proxies||this.node.component.proxies;if(n)for(let[o,i]of Object.entries(n))typeof i=="function"&&i.name?(this.refs.length=0,Object.assign(e,{[o]:i()}),this.nodeElement.reactive(this.refs,"component",()=>{let c=i();this.nodeElement.proxy[o]=c})):Object.assign(e,{[o]:i});return{component:t,proxies:e}}var l=class{constructor(t,e,n,o){this.nodeElement=t,this.props=e,this.append=o,this.data=n}async length(t){t>this.nodeElement.children.length&&await this.add(t),t<this.nodeElement.children.length&&this.remove(t)}async set(t){this.remove(0),await this.add(t.length)}async add(t){let e=this.nodeElement.children.length;for(;t>e;)await this.append(e),e++}remove(t){let e=this.nodeElement.children.length;for(;t<e;)e--,this.nodeElement.children[e].unmount()}};async function w(){if(this.nodeElement.innerHTML===""){let s=(n,o)=>{let i={};if(this.node.component.proxies)for(let[c,r]of Object.entries(this.node.component.proxies))typeof r=="function"&&r.name&&(this.refs.length=0,r.length?Object.assign(i,{[c]:r(n[o],o)}):Object.assign(i,{[c]:r()}),this.nodeElement.reactive(this.refs,"component",(p,a)=>{let m=a[1];if(m)this.nodeElement.children[m].proxy[c]=r(n[m],m);else for(let f=0;f<this.nodeElement.children.length;f++)this.nodeElement.children[f].proxy[c]=r(n[f],f)}));return i};this.refs.length=0;let t=this.node.component.data;this.nodeElement.setAttribute("iterate","");let e=new this.Component(this.node.component,this.context,this.keyNode,this.nodeElement,this.common);if(typeof t!="number")if(Object.getPrototypeOf(this.node.component.data).instance==="Proxy"){let n=t.length,o=this.refs[0],i=o.split("_")[0],c=async p=>{await e.create(this.node.component.src,s(this.node.component.data,p),this.node.component.data[p],p)},r=new l(this.nodeElement,this.node.component.proxies,this.node.component.data,c);if(this.nodeElement.reactive([i],"component",(p,a,m)=>{this.node.component.data=m,r.set.bind(r)(m)}),this.nodeElement.reactive([o],"component",(p,a,m)=>r.length.bind(r)(m)),n)for await(let[p]of t.entries())await c(p)}else for await(let[n,o]of t.entries()){let i=s(t,n);await e.create(this.node.component.src,i,o,n)}}else this.nodeElement.textContent=this.common.errors[1],console.error(this.common.errors[1])}async function E(){this.refs.length=0;let s=this.node.component.precept();if(this.nodeElement.reactive(this.refs,"precept",async()=>{if(this.node.component.precept()){let{component:t,proxies:e}=this.simple();await t.create(this.node.component.src,e)}else this.nodeElement.unmount()}),s){let{component:t,proxies:e}=this.simple();await t.create(this.node.component.src,e)}}var x=class{constructor(t,e,n,o,i){this.common=i,this.component=t,this.context=e,this.keyNode=n,this.nodeElement=o,this.props={methods:{},proxies:{},params:{}}}get options(){return this.component}propsMethods(){let t=this.component.methods;if(t)for(let[e,n]of Object.entries(t))typeof n=="function"&&Object.assign(this.props.methods,{[e]:(...o)=>n.bind(this.context)(...h(o))})}propsParams(t,e){let n=this.component.params;if(n)for(let[o,i]of Object.entries(n))typeof i=="function"&&i.name?Object.assign(this.props.params,{[o]:i(t,e)}):Object.assign(this.props.params,{[o]:i})}async load(t){return t instanceof Promise?(await t)?.default:await t}async create(t,e,n,o){try{if(this.propsMethods(),this.propsParams(n,o),e&&(this.props.proxies=e),t){let i=await this.load(t);await v(this.nodeElement,i,this.props)}}catch(i){console.error(i)}}};async function W(){if(this.nodeElement.advance=async s=>{await new this.Component(s,this.context,this.keyNode,this.nodeElement,this.common).create(s.src,s.proxies,null,!0)},this.nodeElement.integrate=async s=>{let{component:t,proxies:e}=this.simple(s);await t.create(s.src,e)},this.node.component.data)await this.iterate();else if(this.node.component.precept)await this.induce();else{let{component:s,proxies:t}=this.simple();await s.create(this.node.component.src,t)}}var D={Component:x,component:W,simple:g,iterate:w,induce:E};var d=class{constructor(t,e,n,o,i){this.node=t,this.keyNode=e,this.context=n,this.common=i,this.refs=i.refs,this.nodeElement=o,this.nodeElement.reactive=(c,r,p)=>{c.length&&(this.keyNode in this.context.reactiveMap||(this.context.reactiveMap[this.keyNode]={}),c.forEach(a=>{r in this.context.reactiveMap[this.keyNode]||(this.context.reactiveMap[this.keyNode][r]={}),a in this.context.reactiveMap[this.keyNode][r]||(this.context.reactiveMap[this.keyNode][r][a]=[]),this.context.reactiveMap[this.keyNode][r][a].push(p)}))}}};Object.assign(d.prototype,{classes:P});Object.assign(d.prototype,k);Object.assign(d.prototype,D);var L=d;var u=class{constructor(t){this.component=t,this.paramsData={},this.proxiesData=this.component.proxies?h(this.component.proxies):{},this.common={refs:[],errors:N},this.storesHadlers={},this.context={container:null,options:t,node:{},param:{},reactiveMap:{},method:{},proxy:{},setter:{},handler:{},source:t.sources,router:t.router,delay:M}}async created(){this.component.created&&await this.component.created.bind(this.context)()}async loaded(){this.component.loaded&&await this.component.loaded.bind(this.context)()}async prepared(t){this.context.container=t,this.component.prepared&&await this.component.prepared.bind(this.context)()}async mounted(){this.component.mounted&&await this.component.mounted.bind(this.context)()}async unmount(){if(this.component.stores)for(let t of Object.values(this.component.stores))document.addEventListener(t.name,this.storesHadlers[t.name]);this.component.unmount&&await this.component.unmount.bind(this.context)()}stores(){if(this.component.stores)for(let t of Object.values(this.component.stores)){if(t.params)for(let o in t.params)o in this.component.props.params&&(this.context.param[o]={...t.params[o]});if(t.proxies)for(let o in t.proxies)o in this.component.props.proxies&&(this.component.proxies[o]=h(t.proxies[o]));if(t.methods)for(let o in t.methods)o in this.component.props.methods&&(this.context.method[o]=(...i)=>t.methods[o].bind(t)(...h(i)));let e=t.name,n=o=>{let{path:i,value:c}=o.detail;if(t.proxies&&i[0]in this.component.props.proxies){let r=this.context.proxy;if(i.length>0){for(let p=0;p<i.length-1;p++)r=r[i[p]];r[i[i.length-1]]=c}else r[i[0]]=c}};Object.assign(this.storesHadlers,{[e]:n}),document.addEventListener(e,n,!1)}}methods(t){if(t.method||(t.method={}),this.component.methods)for(let[e,n]of Object.entries(this.component.methods))this.context.method[e]=n.bind(this.context),t.method[e]=(...o)=>this.context.method[e](...h(o))}setters(){if(this.component.setters)for(let t in this.component.setters)this.context.setter[t]=e=>this.component.setters[t].bind(this.context)(e)}handlers(){if(this.component.handlers)for(let t in this.component.handlers)this.context.handler[t]=e=>this.component.handlers[t].bind(this.context)(e)}params(){if(this.component.params){this.paramsData=h(this.component.params);for(let t in this.paramsData)this.context.param[t]=this.paramsData[t]}}props(t,e){e.proxy||(e.proxy={});let n=this.context;if(this.component.props){if(t.proxies&&this.component.props.proxies)for(let o in this.component.props.proxies)o in t.proxies?(this.proxiesData[o]=t.proxies[o],Object.defineProperty(e.proxy,o,{set(i){n.proxy[o]=h(i)}})):this.proxiesData[o]=void 0;if(t.methods&&this.component.props.methods)for(let o in t.methods)o in this.component.props.methods&&(this.context.method[o]=t.methods[o]);if(t.params&&this.component.props.params)for(let o in this.component.props.params)o in t.params?this.context.param[o]=h(t.params[o]):this.context.param[o]=void 0;this.validation()}}validation(){if(this.component.props.proxies)for(let[t,e]of Object.entries(this.component.props.proxies))(this.proxiesData[t]===void 0||this.proxiesData[t]===null)&&(this.proxiesData[t]=e.default),this.component.props.proxies[t].type&&!typeof this.proxiesData[t]===this.component.props.proxies[t].type&&console.error("Error props type");if(this.component.props.methods)for(let t in this.component.props.methods)typeof this.component.props.methods!="object"?console.error("Error props type"):this.component.props.methods[t].instance&&this.context.method[t]instanceof this.component.props.methods[t].instance&&console.error("Error props instance");if(this.component.props.params)for(let[t,e]of Object.entries(this.component.props.params))(this.context.param[t]===void 0||this.context.param[t]===null)&&(this.context.param[t]=e.default),this.component.props.params[t].type&&!typeof this.context.param[t]===this.component.props.params[t].type&&console.error("Error props type")}proxies(){let t=this;this.context.proxy=j(h(this.proxiesData),{beforeSet(e,n,o,i){return t.context.setter[i]?.bind(t.context)(o)},async set(e,n,o,i){if(t.context.reactiveMap)for(let c in t.context.reactiveMap)for(let r in t.context.reactiveMap[c]){let p=t.context.reactiveMap[c][r][i];if(p?.length)for(let a of p)await a(e,n,o)}return t.context.handler[i]?.bind(t.context)(o)},get(e,n){t.common.refs.push(n.join("_"))},deleteProperty(e,n){console.log("delete",n.join("_"))}})}async nodes(t){if(this.component.nodes){let e=this.component.nodes.bind(this.context)();for await(let[n,o]of Object.entries(e)){let i=t.querySelector(`.${n}`)||t.classList.contains(n)&&t;if(Object.assign(this.context.node,{[n]:i}),o){let c=new L(o,n,this.context,i,this.common);for await(let[r,p]of Object.entries(o))c.native(r,p),r in c&&await c[r](n,p)}}}}};function z(s,t,e){if(s.template)return t.insertAdjacentHTML("beforeEnd",s.template),t.hasAttribute("iterate")?(t.lastChild.unmount=async()=>{t.lastChild.remove(),await e.unmount()},t.lastChild):(t.unmount=async()=>{await e.unmount(),t.innerHTML=""},t);if(s.fragments){for(let[n,o]of Object.entries(s.fragments)){let i=t.querySelector(`.${n}`);i.hasAttribute("slot")&&(i.unmount=async()=>{await e.unmount(),i.innerHTML=""},i.innerHTML=o)}return t}}async function v(s,t,e={}){if(t){let n=new u(t);await n.created(),n.stores(),n.setters(),n.handlers(),n.params();let o=z(t,s,n);return await n.prepared(o),n.props(e,o),n.methods(o),n.proxies(),await n.nodes(o),await n.mounted(),{options:t,context:n.context}}}return A(B);})();
